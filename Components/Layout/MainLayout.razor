@namespace EverettEats.Components.Layout
@inherits LayoutComponentBase

<div class="notebook-layout">
    <header class="notebook-header">
        <div class="header-content">
            <a href="/" class="notebook-title" @onclick="CloseMobileMenu">
                <span class="title-text">Everett's <span class="title-subtitle-inline">Recipe Notebook</span></span>
            </a>

            <!-- Burger menu for mobile -->
            <button class="mobile-menu-toggle @(isMobileMenuOpen ? "active" : "")"
                    @onclick="ToggleMobileMenu"
                    aria-label="@(isMobileMenuOpen ? "Close menu" : "Open menu")"
                    aria-expanded="@isMobileMenuOpen">
                <span class="burger-line"></span>
                <span class="burger-line"></span>
                <span class="burger-line"></span>
            </button>

            <nav class="notebook-tabs @(isMobileMenuOpen ? "mobile-open" : "")" role="navigation">
                <a href="/" class="tab-link @(GetActiveClass("/"))" @onclick="CloseMobileMenu">
                    <span class="tab-icon">üè†</span>
                    <span class="tab-text">Home</span>
                </a>
                <a href="/recipes" class="tab-link @(GetActiveClass("/recipes"))" @onclick="CloseMobileMenu">
                    <span class="tab-icon">üìñ</span>
                    <span class="tab-text">All Recipes</span>
                </a>
                <a href="/favorites" class="tab-link @(GetActiveClass("/favorites"))" @onclick="CloseMobileMenu">
                    <span class="tab-icon">‚ù§Ô∏è</span>
                    <span class="tab-text">Favorites</span>
                </a>
            </nav>
        </div>
    </header>

    @if (isMobileMenuOpen)
    {
        <div class="mobile-menu-overlay" @onclick="CloseMobileMenu"></div>
    }

    <main class="notebook-pages" @onclick="CloseMobileMenu">
        <div class="page-lines"></div>
        <div class="page-content">
            @Body
        </div>
    </main>
</div>

@code {
    [Inject] NavigationManager Navigation { get; set; } = default!;
    private bool isMobileMenuOpen = false;
    
    private string GetActiveClass(string path)
    {
        var currentPath = Navigation.Uri.Replace(Navigation.BaseUri, "/");
        return currentPath.StartsWith(path) && (path != "/" || currentPath == "/") ? "active" : "";
    }
    
    private void ToggleMobileMenu()
    {
        isMobileMenuOpen = !isMobileMenuOpen;
    }
    
    private void CloseMobileMenu()
    {
        isMobileMenuOpen = false;
    }
}

@page "/recipe/{Slug}"
@using EverettEats.Models
@using EverettEats.Services
@inject IRecipeService RecipeService
@inject NavigationManager Navigation

@if (recipe != null)
{
    <div class="recipe-detail-page">
        <div class="recipe-header">
            <button @onclick="GoBack" class="back-button">
                ‚Üê Back to recipes
            </button>
            
            <h1 class="recipe-title">@recipe.Title</h1>
            
            <div class="recipe-quick-info">
                <span class="info-item">‚è±Ô∏è Prep: @recipe.PrepTime</span>
                <span class="info-item">üî• Cook: @recipe.CookTime</span>
                <span class="info-item">üçΩÔ∏è Serves: @recipe.Servings</span>
            </div>
        </div>

        <div class="recipe-content">
            <div class="ingredients-section">
                <h2 class="section-header">
                    <span>Shopping List</span>
                    <span class="pencil-mark">‚úì</span>
                </h2>
                
                <ul class="ingredients-list">
                    @foreach (var ingredient in recipe.Ingredients)
                    {
                        <li class="ingredient-item">
                            <input type="checkbox" id="ing-@ingredient.GetHashCode()" class="ingredient-checkbox" />
                            <label for="ing-@ingredient.GetHashCode()">@ingredient</label>
                        </li>
                    }
                </ul>
                
                <div class="sticky-note">
                    <p class="note-text">Don't forget to check the pantry first! üòä</p>
                </div>
            </div>

            <div class="instructions-section">
                <h2 class="section-header">
                    <span>Let's Cook!</span>
                    <span class="doodle-arrow">‚Üì</span>
                </h2>
                
                <ol class="instructions-list">
                    @foreach (var instruction in recipe.Instructions)
                    {
                        <li class="instruction-item">
                            <p>@instruction</p>
                        </li>
                    }
                </ol>
                
                @if (recipe.Tips.Any())
                {
                    <div class="tips-section">
                        <h3 class="tips-header">üí° Notes to Self:</h3>
                        <ul class="tips-list">
                            @foreach (var tip in recipe.Tips)
                            {
                                <li class="tip-item">@tip</li>
                            }
                        </ul>
                    </div>
                }
            </div>
        </div>
    </div>
}
else
{
    <div class="loading-state">
        <p>Looking for that recipe... üìñ</p>
    </div>
}

@code {
    [Parameter] public string Slug { get; set; } = "";
    private Recipe? recipe;

    protected override async Task OnInitializedAsync()
    {
        recipe = await RecipeService.GetRecipeBySlugAsync(Slug);
    }

    private void GoBack()
    {
        Navigation.NavigateTo("/");
    }
}